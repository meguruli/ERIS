### ERIS (Moonbit 版) — 目前工作完成度报告

**简介**

ERIS (Encoding for Robust Immutable Storage) 是一种将任意内容编码为一组大小统一、经过加密和内容寻址的块的规范，适用于去中心化与抗审查的数据存储与共享。该文档记录当前 Moonbit 实现（仓库 `ERIS`）的实现进度与后续计划。

**任务范围（摘录）**
- 实现核心算法：编码（Encoding）与解码（Decoding）
- 实现加密原语：Blake2b-256（含键控哈希）、ChaCha20 等
- 实现树状数据结构（叶节点与内部节点）与两种块大小（1KiB、32KiB）
- 支持收敛密钥（convergence secret）与读能力（read capability）序列化（66 字节二进制 + Base32 URN）
- 模块化块存储接口（抽象化以支持内存/文件/网络后端）
- 流式（streaming）编解码以提高大文件处理效率
- 兼容官方测试向量（正向、负向与大文件测试）

**当前完成情况（概要）**
- **项目初始化与仓库配置** — 已完成：仓库已在 `https://github.com/meguruli/ERIS.git` 建立并推送当前代码。  

- **代码骨架与模块划分** — 已完成：实现了项目的模块化结构（核心模块、加密原语封装、块存储抽象、测试向量目录）。  

- **加密原语集成** — 部分完成：已集成/封装 Blake2b-256 与 ChaCha20 的底层调用（使用已存在库或实现），并提供统一接口用于编码流程。需要完成的工作：对键控 Blake2b 的边界条件做额外测试并完善互操作性细节。  

- **编码/解码核心算法** — 部分完成：已实现编码器与解码器的基础流程与树构建逻辑，支持两种块大小（1KiB、32KiB）的基本路径。需要完成的工作：细化填充规则、边界条件处理、以及更稳健的错误检测与报告（例如无效填充或损坏块的精确错误类型）。  

- **读能力（read capability）序列化** — 部分完成：已实现 66 字节二进制序列化的草案与 Base32 URN 的编码/解码函数；仍需通过官方测试向量校验并处理异常输入的反序列化错误信息。  

- **块存储抽象（BlockStore 接口）** — 已完成：设计并实现了抽象接口，当前提供内存实现与文件系统示例实现，方便未来扩展到网络/分布式后端。  

- **流式编解码** — 进行中：编码器已支持分块输入流式处理，解码器的流式按需加载与并发预取正在完善中以降低内存峰值。  

- **测试覆盖（官方向量）** — 进行中：已通过部分小型与正向测试向量；**尚未全部通过**大型与负向测试。当前正在扩展测试用例并修复在边界向量上暴露的问题。  

**已知问题与风险**
- 对于极大型内容（多 GiB）需要更多集成与压力测试以验证流式实现和 I/O 性能。  
- 某些负向测试暴露了对损坏块的错误处理不足，需要更严格的完整性校验和错误分类。  
- 键控 Blake2b 与 ChaCha20 的跨实现互操作性需要通过对照测试向量逐项校验。  



**下一步计划（短期）**
- 完成对官方全部测试向量的覆盖，修复负向/大型测试中发现的问题。  
- 强化错误处理与日志，在解码失败时提供明确的诊断信息以便排查。  
- 完善流式解码器的并发读策略（预取队列、限速与内存上限）。  
- 撰写 API 文档与示例代码，包含编码/解码、read-capability 生成与解析、以及自定义块存储的接入示例。  

**长期目标（里程碑）**
- 发布稳定 1.0.0 版本，保证与 ERIS 规范 v1.0.0 完整兼容。  
- 在 Moonbit 生态中推广并在示例工程（去中心化文件系统、内容分发）中集成验证。  

**如何贡献或联络**
- 提交 Issue 或 Pull Request 到仓库：`https://github.com/meguruli/ERIS`。  
- 对于重大变更（例如替换加密库或调整块格式），请先提交设计说明（RFC）以便评审。  

---

此文档会随实现进度持续更新。如需我将 README 调整为更精确的百分比或自动从 CI/测试结果生成的状态板，请告诉我你希望的数据源（本地测试结果、CI 服务或测试向量输出）。
